\doxysection{shape\+\_\+spherical\+\_\+harmonics.\+hpp}
\hypertarget{shape__spherical__harmonics_8hpp_source}{}\label{shape__spherical__harmonics_8hpp_source}\index{/Users/lzhshou/Documents/Research/myProjects/apaam/repo/netdem/src/shape/shape\_spherical\_harmonics.hpp@{/Users/lzhshou/Documents/Research/myProjects/apaam/repo/netdem/src/shape/shape\_spherical\_harmonics.hpp}}
\mbox{\hyperlink{shape__spherical__harmonics_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{shape_8hpp}{shape.hpp}}"{}}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{stl__model_8hpp}{stl\_model.hpp}}"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{stl__reader_8hpp}{stl\_reader.hpp}}"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacenetdem}{netdem}}\ \{}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00024\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classnetdem_1_1_spherical_harmonics}{SphericalHarmonics}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classnetdem_1_1_shape}{Shape}}\ \{}
\DoxyCodeLine{00025\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00026\ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a317c0eef721ba0a4cbd4b06fa21435e6}{degree}}\{8\};\ \ \ \ \ \ }
\DoxyCodeLine{00027\ \ \ \mbox{\hyperlink{namespacenetdem_a19bd090a5819e5163bd8d6aba69718bc}{VecXT<double>}}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a7048aa9b5a0944e1e7411288b431bd92}{a\_nm}};\ }
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00034\ \ \ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a6fd7c3f71dae690838be314af0df3b63}{SphericalHarmonics}}();}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00041\ \ \ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a6fd7c3f71dae690838be314af0df3b63}{SphericalHarmonics}}(\textcolor{keywordtype}{int}\ n);}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00051\ \ \ nlohmann::json\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_ae5c2ac3aca67f0ea1c884ba4deb447cd}{PackJson}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00061\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a72a0d3e590ad342c0a410ae55397e7af}{InitFromJson}}(nlohmann::json\ \textcolor{keyword}{const}\ \&js)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00071\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a29163114283ad8d10208a182031d0a97}{InitFromSTL}}(std::string\ \textcolor{keyword}{const}\ \&file);}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00081\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a29163114283ad8d10208a182031d0a97}{InitFromSTL}}(\mbox{\hyperlink{classnetdem_1_1_s_t_l_model}{STLModel}}\ \textcolor{keyword}{const}\ \&stl\_model);}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00093\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_aff0aab3dedcfe8a1dfa44bf868575fd2}{InitFromSurfacePoints}}(\mbox{\hyperlink{namespacenetdem_a19bd090a5819e5163bd8d6aba69718bc}{VecXT<Vec3d>}}\ \textcolor{keyword}{const}\ surf\_points);}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00101\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a7d23e867d3f00056f118364cb0bfaa2b}{Init}}();}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00109\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a6cef816d35193ae64ffb0e86b9394453}{UpdateSurfaceNodes}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00117\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a9f84fe652a69751e530000c47fb3930f}{UpdateShapeProperties}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00127\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a2b24a5482693a665391131da80fceebb}{SetSize}}(\textcolor{keywordtype}{double}\ d)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00140\ \ \ \mbox{\hyperlink{classnetdem_1_1_s_t_l_model}{STLModel}}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a2d59cf9cf5ed7a19c584001dc1baae04}{GetSTLModel}}(\textcolor{keywordtype}{int}\ num\_nodes\ =\ 200)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00148\ \ \ \mbox{\hyperlink{classnetdem_1_1_shape}{Shape}}\ *\mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a1eb2eaa5a54e1c07768d093c266b6f4c}{Clone}}()\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00162\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a74a30568efb6d21795c3662faa0578fd}{SignedDistance}}(\mbox{\hyperlink{namespacenetdem_a510a89239abc51ed4d8d88ce7ee403df}{Vec3d}}\ \textcolor{keyword}{const}\ \&\mbox{\hyperlink{namespacenetdem_a3c02b9c21c10a18b737b5591b4c0c324}{pos}})\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00175\ \ \ \mbox{\hyperlink{namespacenetdem_a510a89239abc51ed4d8d88ce7ee403df}{Vec3d}}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a20f4f0db7374cdc2608c5a7fe9df7d5d}{SurfacePoint}}(\mbox{\hyperlink{namespacenetdem_a510a89239abc51ed4d8d88ce7ee403df}{Vec3d}}\ \textcolor{keyword}{const}\ \&\mbox{\hyperlink{namespacenetdem_a3c02b9c21c10a18b737b5591b4c0c324}{pos}})\ \textcolor{keyword}{override};}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \mbox{\hyperlink{namespacenetdem_a510a89239abc51ed4d8d88ce7ee403df}{Vec3d}}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_aea85c1b5a3ebdd868e772b64d43004de}{SurfaceNormal}}(\mbox{\hyperlink{namespacenetdem_a510a89239abc51ed4d8d88ce7ee403df}{Vec3d}}\ \textcolor{keyword}{const}\ \&\mbox{\hyperlink{namespacenetdem_a3c02b9c21c10a18b737b5591b4c0c324}{pos}});}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \mbox{\hyperlink{namespacenetdem_a139321f45979f79c80f456258a9e1598}{Vec2d}}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a02419518b9880d93929f1903904ef4db}{SurfaceCurvature}}(\mbox{\hyperlink{namespacenetdem_a510a89239abc51ed4d8d88ce7ee403df}{Vec3d}}\ \textcolor{keyword}{const}\ \&\mbox{\hyperlink{namespacenetdem_a3c02b9c21c10a18b737b5591b4c0c324}{pos}});}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \ \ \mbox{\hyperlink{namespacenetdem_a510a89239abc51ed4d8d88ce7ee403df}{Vec3d}}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_aea85c1b5a3ebdd868e772b64d43004de}{SurfaceNormal}}(\textcolor{keywordtype}{double}\ theta,\ \textcolor{keywordtype}{double}\ phi);}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ \mbox{\hyperlink{namespacenetdem_a139321f45979f79c80f456258a9e1598}{Vec2d}}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a02419518b9880d93929f1903904ef4db}{SurfaceCurvature}}(\textcolor{keywordtype}{double}\ theta,\ \textcolor{keywordtype}{double}\ phi);}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00197\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespacenetdem_a19bd090a5819e5163bd8d6aba69718bc}{VecXT<double>}}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a174192a206b75bb933af920bcde03bed}{CalculateYnm}}(\textcolor{keywordtype}{double}\ theta,\ \textcolor{keywordtype}{double}\ phi,\ \textcolor{keywordtype}{int}\ deg);}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00211\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespacenetdem_a19bd090a5819e5163bd8d6aba69718bc}{VecXT<VecXT<double>}}>\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a174192a206b75bb933af920bcde03bed}{CalculateYnm}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacenetdem_a19bd090a5819e5163bd8d6aba69718bc}{VecXT<double>}}\ \&theta,}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacenetdem_a19bd090a5819e5163bd8d6aba69718bc}{VecXT<double>}}\ \&phi,\ \textcolor{keywordtype}{int}\ deg);}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00226\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespacenetdem_a19bd090a5819e5163bd8d6aba69718bc}{VecXT<double>}}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a3332816349661bd4a8b346136879ba9f}{CalculateYnm\_Fast}}(\textcolor{keywordtype}{double}\ theta,\ \textcolor{keywordtype}{double}\ phi,\ \textcolor{keywordtype}{int}\ deg);}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00241\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespacenetdem_a19bd090a5819e5163bd8d6aba69718bc}{VecXT<VecXT<double>}}>\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a3332816349661bd4a8b346136879ba9f}{CalculateYnm\_Fast}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacenetdem_a19bd090a5819e5163bd8d6aba69718bc}{VecXT<double>}}\ \&theta,}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespacenetdem_a19bd090a5819e5163bd8d6aba69718bc}{VecXT<double>}}\ \&phi,}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ deg);}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00255\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a5422fbfd563d228900769901395351e1}{CalculateRho}}(\textcolor{keywordtype}{double}\ theta,\ \textcolor{keywordtype}{double}\ phi)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \ \ \textcolor{comment}{//\ another\ fast\ option\ by\ using\ unit\ VecXT\ as\ direction\ (thus\ to\ avoid\ sin}}
\DoxyCodeLine{00258\ \ \ \textcolor{comment}{//\ and\ cos)}}
\DoxyCodeLine{00259\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespacenetdem_a19bd090a5819e5163bd8d6aba69718bc}{VecXT<double>}}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a3332816349661bd4a8b346136879ba9f}{CalculateYnm\_Fast}}(\mbox{\hyperlink{namespacenetdem_a510a89239abc51ed4d8d88ce7ee403df}{Vec3d}}\ \textcolor{keyword}{const}\ \&dir,\ \textcolor{keywordtype}{int}\ deg);}
\DoxyCodeLine{00260\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespacenetdem_a19bd090a5819e5163bd8d6aba69718bc}{VecXT<VecXT<double>}}>\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a3332816349661bd4a8b346136879ba9f}{CalculateYnm\_Fast}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{namespacenetdem_a19bd090a5819e5163bd8d6aba69718bc}{VecXT<Vec3d>}}\ \&dir\_list,}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ deg);}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00272\ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classnetdem_1_1_spherical_harmonics_a5422fbfd563d228900769901395351e1}{CalculateRho}}(\mbox{\hyperlink{namespacenetdem_a510a89239abc51ed4d8d88ce7ee403df}{Vec3d}}\ \textcolor{keyword}{const}\ \&dir)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00286\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespacenetdem_a19bd090a5819e5163bd8d6aba69718bc}{VecXT<VecXT<double>}}>\ sph\_legendre\_fast(\textcolor{keywordtype}{double}\ theta,\ \textcolor{keywordtype}{int}\ deg);}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00299\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{namespacenetdem_a19bd090a5819e5163bd8d6aba69718bc}{VecXT<VecXT<double>}}>\ sph\_legendre\_fast(\mbox{\hyperlink{namespacenetdem_a510a89239abc51ed4d8d88ce7ee403df}{Vec3d}}\ \textcolor{keyword}{const}\ \&dir,\ \textcolor{keywordtype}{int}\ deg);}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \textcolor{keywordtype}{double}\ d\_rho\_d\_theta(\textcolor{keywordtype}{double}\ theta,\ \textcolor{keywordtype}{double}\ phi);}
\DoxyCodeLine{00302\ }
\DoxyCodeLine{00303\ \ \ \textcolor{keywordtype}{double}\ d\_rho\_d\_phi(\textcolor{keywordtype}{double}\ theta,\ \textcolor{keywordtype}{double}\ phi);}
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00305\ \ \ \mbox{\hyperlink{namespacenetdem_a510a89239abc51ed4d8d88ce7ee403df}{Vec3d}}\ d\_xyz\_d\_theta(\textcolor{keywordtype}{double}\ theta,\ \textcolor{keywordtype}{double}\ phi);}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \ \ \mbox{\hyperlink{namespacenetdem_a510a89239abc51ed4d8d88ce7ee403df}{Vec3d}}\ d\_xyz\_d\_phi(\textcolor{keywordtype}{double}\ theta,\ \textcolor{keywordtype}{double}\ phi);}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \ \ \mbox{\hyperlink{namespacenetdem_a510a89239abc51ed4d8d88ce7ee403df}{Vec3d}}\ d\_normal\_d\_theta(\textcolor{keywordtype}{double}\ theta,\ \textcolor{keywordtype}{double}\ phi);}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \ \ \mbox{\hyperlink{namespacenetdem_a510a89239abc51ed4d8d88ce7ee403df}{Vec3d}}\ d\_normal\_d\_phi(\textcolor{keywordtype}{double}\ theta,\ \textcolor{keywordtype}{double}\ phi);}
\DoxyCodeLine{00312\ \};}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00314\ \}\ \textcolor{comment}{//\ namespace\ netdem}}

\end{DoxyCode}
