<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="https://apaam.github.io/webpage/img/favicon.ico">
        <meta name="keywords" content="Finite Element Library,Finite Element Code,Finite Element Method Library,Finite Element Method Code,Finite Element C++,Finite Element Method C++,Finite Element Library C++,Finite Element Code C++,FEM Code,FEM Library,FEM C++">
        <meta name="google-site-verification" content="45K56TawSdzbgy-uDtfJdYwp7zaVdL3fIAGYt869wwU" />
<!--	<title></title>  -->
        <title>NetDEM - Neural Network Enabled Discret Element Method</title>

        <link href="../../css/bootstrap-bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../../css/highlight.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="https://apaam.github.io/webpage/">NetDEM</a>
        </div>

        <script>var base_url = '../..';</script>
        <!-- <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script> -->

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
            
            
            
                <li >
                    <!-- Replace "nav_item.url|url" with "nav_item.url" for older mkdocs (before 1.0) -->
                    <a href="../">Examples</a>
                </li>
            
            
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
                            <li >
                                 <a href="../../documentation/user_manual/">User manual</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../../documentation/developer_manual/">Developer manual</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../../documentation/dem_wiki/">DEM wiki</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../../doxygen/html/">Code doxygen</a>
                            </li>
                        
                    
                    </ul>
                </li>
            
            
            
            
            
                <li >
                    <!-- Replace "nav_item.url|url" with "nav_item.url" for older mkdocs (before 1.0) -->
                    <a href="../../download/">Download</a>
                </li>
            
            
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Gallery <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
                            <li >
                                 <a href="../../gallery/snapshots/">Snapshots</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../../gallery/animations/">Animations</a>
                            </li>
                        
                    
                    </ul>
                </li>
            
            
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
                            <li >
                                 <a href="../../about/help_%26_support/">Help & Support</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../../about/publications/">Publications</a>
                            </li>
                        
                    
                        
                            <li >
                                 <a href="../../about/acknowledgement/">Acknowledgements</a>
                            </li>
                        
                    
                    </ul>
                </li>
            
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li class="nav-item">
                    <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                
                <li>
                    <a href="https://github.com/apaam/webpage">
                        
                            <i class="fa fa-github-square"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        
        <div class="container">
            
            <div class="col-md-3 visible-xs visible-sm"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#_1"></a></li>
        
    
        <li class="main "><a href="#blade-mixing">Blade mixing</a></li>
        
            <li><a href="#whole-script"> &#9731; Whole script</a></li>
        
            <li><a href="#step-by-step-explaination"> &#9731; Step-by-step explaination</a></li>
        
            <li><a href="#simulation-result"> &#9731; Simulation result</a></li>
        
    
    </ul>
</div></div> <!-- toc on top on mobile -->
            <div class="col-md-3 hidden-xs hidden-sm"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#_1"></a></li>
        
    
        <li class="main "><a href="#blade-mixing">Blade mixing</a></li>
        
            <li><a href="#whole-script"> &#9731; Whole script</a></li>
        
            <li><a href="#step-by-step-explaination"> &#9731; Step-by-step explaination</a></li>
        
            <li><a href="#simulation-result"> &#9731; Simulation result</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<div><h3 id="_1"></h3>
<p><a href="../">Example</a>
┊ <a href="../random_packing/">Previous</a>
┊ <a href="../">Next</a></p>
<hr>
<h3 id="blade-mixing">Blade mixing</h3>
<h4 id="whole-script">Whole script</h4>
<p>The code is a C++ implementation of a simulation using the netdem library. It sets up a simulation environment, including the simulation domain, contact model, shapes, walls, gravity, data dumping, and runs the simulation.</p>
<pre><code class="language-cpp">#include "data_dumper.hpp"
#include "gen_pack.hpp"
#include "gen_wall_box_plane.hpp"
#include "gravity.hpp"
#include "model_linear_spring.hpp"
#include "shape_cylinder.hpp"
#include "shape_sphere.hpp"
#include "shape_triangle.hpp"
#include "simulation.hpp"
#include &lt;iostream&gt;
#include &lt;unordered_map&gt;
using namespace netdem;
using namespace std;

void ImportWall(Simulation *sim) {
  STLModel cylinder_stl;
  cylinder_stl.InitFromSTL("data/cylinder.stl");
  for (auto &amp;vert : cylinder_stl.vertices) {
    vert[2] *= 0.5;
  }
  cylinder_stl.SaveAsSTL("tmp/tests/cylinder_outer.stl");
  for (auto &amp;facet : cylinder_stl.facets) {
    Triangle triangle(cylinder_stl.vertices[facet[0]],
                      cylinder_stl.vertices[facet[1]],
                      cylinder_stl.vertices[facet[2]]);
    auto shape_ptr = sim-&gt;scene.InsertShape(&amp;triangle);
    Wall wall(shape_ptr);
    sim-&gt;scene.InsertWall(wall);
  }

  for (auto &amp;vert : cylinder_stl.vertices) {
    vert[0] *= 0.15;
    vert[1] *= 0.15;
    vert[2] *= 0.64;
    vert[2] -= 0.10;
  }
  cylinder_stl.SaveAsSTL("tmp/tests/cylinder_inner.stl");
  for (auto &amp;facet : cylinder_stl.facets) {
    Triangle triangle(cylinder_stl.vertices[facet[0]],
                      cylinder_stl.vertices[facet[1]],
                      cylinder_stl.vertices[facet[2]]);
    auto shape_ptr = sim-&gt;scene.InsertShape(&amp;triangle);
    Wall wall(shape_ptr);
    sim-&gt;scene.InsertWall(wall);
  }

  STLModel propeller_stl;
  propeller_stl.InitFromSTL("data/copyleft/propeller.stl");
  propeller_stl.Standardize();
  for (auto &amp;vert : propeller_stl.vertices) {
    vert[0] *= 0.14;
    vert[1] *= 0.14;
    vert[2] *= 0.8;
    vert[2] -= 0.075;
  }
  propeller_stl.SaveAsSTL("tmp/tests/propeller.stl");
  for (auto &amp;facet : propeller_stl.facets) {
    Triangle triangle(propeller_stl.vertices[facet[0]],
                      propeller_stl.vertices[facet[1]],
                      propeller_stl.vertices[facet[2]]);
    triangle.skin *= 10.0;
    auto shape_ptr = sim-&gt;scene.InsertShape(&amp;triangle);
    Wall wall;
    wall.SetShape(shape_ptr, true);
    wall.SetVelocitySpin(0, 0, -2.0 * Math::PI);
    sim-&gt;scene.InsertWall(wall);
  }
}

int main(int argc, char **argv) {
  Simulation *sim = new Simulation();

  sim-&gt;domain_manager.SetBound(-0.6, -0.6, -0.6, 0.6, 0.6, 0.6);
  sim-&gt;domain_manager.SetCellSpacing(0.2, 0.2, 0.2);

  LinearSpring cnt_model = LinearSpring(1.0e4, 1.0e4, 0.7, 0.5);
  sim-&gt;scene.InsertContactModel(&amp;cnt_model);
  sim-&gt;scene.SetNumberOfMaterials(1);
  sim-&gt;scene.SetCollisionModel(0, 0, cnt_model.label);

  Sphere sphere = Sphere(0.02);
  sphere.skin *= 1.0;
  auto shape_ptr = sim-&gt;scene.InsertShape(&amp;sphere);

  VecXT&lt;Particle&gt; particle_list = PackGenerator::GetGridPack(
      0.7, 0.7, 0.1, 0, 0, 0.2, 25, 20, 2, sim-&gt;scene.GetShapes());
  for (auto &amp;p : particle_list) {
    p.SetVelocity(0, 0, -2.0);
  }

  ImportWall(sim);

  Gravity grav;
  grav.Init(sim);
  sim-&gt;modifier_manager.Insert(&amp;grav);
  sim-&gt;modifier_manager.Enable(grav.label);

  DataDumper data_dumper;
  data_dumper.Init(sim);
  data_dumper.SetRootPath("tmp/out/");
  data_dumper.SetSaveByCycles(100);
  data_dumper.dump_wall_info = true;
  data_dumper.dump_shape_info = true;
  sim-&gt;modifier_manager.Insert(&amp;data_dumper);
  sim-&gt;modifier_manager.Enable(data_dumper.label);

  for (int i = 0; i &lt; 20; i++) {
    sim-&gt;scene.InsertParticle(particle_list);
    sim-&gt;Run(0.1);
  }
  sim-&gt;Run(2.0);

  delete sim;
}
</code></pre>
<h4 id="step-by-step-explaination">Step-by-step explaination</h4>
<p>Here's a breakdown of the code:</p>
<pre><code class="language-cpp">void ImportWall(Simulation *sim) {
  // ...
}
</code></pre>
<p>This function defines the <code>ImportWall</code> function, which is used to import wall shapes into the simulation. The walls are created based on STL models and inserted into the simulation scene.</p>
<pre><code class="language-cpp">int main(int argc, char **argv) {
  Simulation *sim = new Simulation();
</code></pre>
<p>The <code>main</code> function initializes a new <code>Simulation</code> object and assigns it to the <code>sim</code> pointer.</p>
<pre><code class="language-cpp">  sim-&gt;domain_manager.SetBound(-0.6, -0.6, -0.6, 0.6, 0.6, 0.6);
  sim-&gt;domain_manager.SetCellSpacing(0.2, 0.2, 0.2);
</code></pre>
<p>The boundary and cell spacing of the simulation domain are set using the methods <code>SetBound</code> and <code>SetCellSpacing</code> of the <code>domain_manager</code> object.</p>
<pre><code class="language-cpp">  LinearSpring cnt_model = LinearSpring(1.0e4, 1.0e4, 0.7, 0.5);
  sim-&gt;scene.InsertContactModel(&amp;cnt_model);
  sim-&gt;scene.SetNumberOfMaterials(1);
  sim-&gt;scene.SetCollisionModel(0, 0, cnt_model.label);
</code></pre>
<p>A linear spring contact model is created and inserted into the simulation scene using the <code>InsertContactModel</code> method of the <code>scene</code> object. The number of materials in the scene is set to 1, and the collision model at index 0 is updated with the label of the contact model.</p>
<pre><code class="language-cpp">  Sphere sphere = Sphere(0.02);
  sphere.skin *= 1.0;
  auto shape_ptr = sim-&gt;scene.InsertShape(&amp;sphere);
</code></pre>
<p>A sphere shape is created and inserted into the simulation scene using the <code>InsertShape</code> method of the <code>scene</code> object. The sphere's skin (radius) is adjusted, and the resulting shape pointer is stored for later use.</p>
<pre><code class="language-cpp">  VecXT&lt;Particle&gt; particle_list = PackGenerator::GetGridPack(
      0.7, 0.7, 0.1, 0, 0, 0.2, 25, 20, 2, sim-&gt;scene.GetShapes());
  for (auto &amp;p : particle_list) {
    p.SetVelocity(0, 0, -2.0);
  }
</code></pre>
<p>A grid-based particle pack is generated using the <code>GetGridPack</code> method of the <code>PackGenerator</code> class. The parameters provided determine the position, size, and layout of the particles in the grid. The initial velocity of each particle in the pack is set to move downward.</p>
<pre><code class="language-cpp">  ImportWall(sim);
</code></pre>
<p>The <code>ImportWall</code> function is called to import wall shapes into the simulation.</p>
<pre><code class="language-cpp">  Gravity grav;
  grav.Init(sim);
  sim-&gt;modifier_manager.Insert(&amp;grav);
  sim-&gt;modifier_manager.Enable(grav.label);
</code></pre>
<p>A gravity modifier is created, initialized with the simulation object, inserted into the modifier manager, and enabled.</p>
<pre><code class="language-cpp">  DataDumper data_dumper;
  data_dumper.Init(sim);
  data_dumper.SetRootPath("tmp/out/");
  data_dumper.SetSaveByCycles(100);
  data_dumper.dump_wall_info = true;
  data_dumper.dump_shape_info = true;
  sim-&gt;modifier_manager.Insert(&amp;data_dumper);
  sim-&gt;modifier_manager.Enable(data_dumper.label);
</code></pre>
<p>A data dumper object is created, initialized with the simulation object, and configured to save data by cycles. The root path for saving files is set, and options for dumping wall and shape information are enabled. The data dumper object is then inserted into the modifier manager and enabled.</p>
<pre><code class="language-cpp">  for (int i = 0; i &lt; 20; i++) {
    sim-&gt;scene.InsertParticle(particle_list);
    sim-&gt;Run(0.1);
  }
  sim-&gt;Run(2.0);

  delete sim;
}
</code></pre>
<p>A loop is used to insert particles from the particle list into the simulation scene, and the simulation is run for a duration of 0.1 time units. This loop allows the particles to settle in the simulation before further simulation steps. After the loop, the simulation is run for an additional 2.0 time units. Finally, the <code>sim</code> pointer is deleted to free the memory.</p>
<h4 id="simulation-result">Simulation result</h4>
<hr>
<p><a href="../">Example</a>
┊ <a href="../random_packing/">Previous</a>
┊ <a href="../">Next</a></p></div></div>
            <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>Enter your search keywords below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
            
        </div>
        

        <footer class="footer">
           <div class="container">
              <p class="text-muted alignleft">
                  <span id="busuanzi_container_site_uv" style='display:none'>Vistors: <span id="busuanzi_value_site_uv"></span>. </span>
              </p>
              <p class="text-muted alignright">
                &copy; <a href="https://apaam.github.io/webpage/about/acknowledgement/">NetDEM Team</a>. SYSU, HKUST.
              </p>
           </div>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
        <script src="../../js/retina.min.js"></script>
        <!-- <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script> -->
        <script src="../../mathjax-config.js"></script>
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <script src="../../search/main.js"></script>
    </body>
</html>